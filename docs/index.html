<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
  <title>DPC Fantasy Tracker · Hawkie</title>
</head>

<body>
  <div class="container">
    <h1 class="display-1 text-center my-4">Dota Pro Circuit Fantasy Tracker</h1>

    <div id="league-grid" class="row row-cols-1 row-cols-md-2 row-cols-lg-3 g-4 my-4"></div>

    <footer class="d-flex justify-content-center align-items-center pt-2 mt-4 border-top">
      <p class="text-center text-muted">Created by Hawkie. Powered by OpenDota and datdota.</p>
    </footer>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>

  <script>
    fetch("./data/league_list.json")
      .then(response => response.json())
      .then(function(league_list) {
        league_list.forEach(league => {
          fetch("./data/" + league.league_id + ".json")
            .then(response => response.json())
            .then(function(league_data) {
              var col = document.createElement("div");
              col.className = "col";

              var cardContainer = document.createElement("div");
              cardContainer.className = "card h-100";

              var cardImage = document.createElement("img");
              cardImage.src = "./img/" + league.league_id + ".png";
              cardImage.className = "card-img-top";

              var cardBody = document.createElement("div");
              cardBody.className = "card-body";

              var cardTitle = document.createElement("h5");
              cardTitle.className = "card-title";
              cardTitle.innerHTML = league_data.name;

              var cardSubTitle = document.createElement("h6");
              cardSubTitle.className = "card-subtitle mb-2 text-muted";
              const startDate = new Date(league_data.start_date * 1000)
                .toLocaleDateString(
                  'en-gb', {
                    year: 'numeric',
                    month: 'short',
                    day: 'numeric',
                    timeZone: 'utc'
                  });
              const endDate = new Date(league_data.end_date * 1000)
                .toLocaleDateString(
                  'en-gb', {
                    year: 'numeric',
                    month: 'short',
                    day: 'numeric',
                    timeZone: 'utc'
                  });
              cardSubTitle.innerHTML = startDate + " – " + endDate;

              var link = document.createElement("a")
              link.href = "./league.html?id=" + league.league_id;
              link.className = "stretched-link"

              cardBody.append(cardTitle);
              cardBody.append(cardSubTitle);
              cardBody.append(link);
              cardContainer.append(cardImage);
              cardContainer.append(cardBody);
              col.append(cardContainer);

              document.querySelector("#league-grid").append(col);
            });
        });
      });
  </script>
</body>

</html>
